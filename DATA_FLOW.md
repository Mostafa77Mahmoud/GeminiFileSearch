# ğŸ”„ Ø´Ø±Ø­ ÙƒØ§Ù…Ù„ Ø§Ù„ Data Flow - Gemini File Search System

## ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®: 24 Ù†ÙˆÙÙ…Ø¨Ø± 2025

---

## ğŸ¯ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„ Data Flow

```
Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ±ÙØ¹ Ø¹Ù‚Ø¯
        â†“
[1] Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨Ù†ÙˆØ¯ (Gemini API)
        â†“
[2] Ø¨Ø­Ø« Ø¬Ù…Ø§Ø¹ÙŠ (File Search API)
        â†“
[3] ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø­Ø³Ø§Ø³Ø©
        â†“
[4-8] Ø¨Ø­Ø« Ù…Ø¹Ù…Ù‘Ù‚ Ù„ÙƒÙ„ Ø¨Ù†Ø¯ (File Search API) Ã—5
        â†“
[9] Ø¯Ù…Ø¬ ÙˆØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
        â†“
[10] Ø­ÙØ¸ ÙÙŠ results/ + Ø¹Ø±Ø¶ ÙÙŠ Streamlit
```

---

## ğŸ“‹ Request #1: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨Ù†ÙˆØ¯ (Gemini API Call)

### Ø§Ù„ÙˆÙ‚Øª: 0-30 Ø«Ø§Ù†ÙŠØ©
### Ù†ÙˆØ¹ Ø§Ù„Ù€ Request: `POST /extract_terms`

### Ø§Ù„ Payload Ø§Ù„Ø°ÙŠ ÙŠÙØ±Ø³Ù„:

```python
{
    "contract_text": """
    Ù†Øµ Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„ÙƒØ§Ù…Ù„ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…...
    Ù‚Ø¯ ÙŠÙƒÙˆÙ† 5000-20000 Ø­Ø±Ù
    ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙƒÙ„ Ø´Ø±ÙˆØ· Ø§Ù„Ø¹Ù‚Ø¯ ÙˆØ§Ù„Ø¨Ù†ÙˆØ¯
    """
}
```

### Ø§Ù„Ù€ HTTP Headers:

```
POST http://127.0.0.1:5001/extract_terms HTTP/1.1
Host: 127.0.0.1:5001
Content-Type: application/json
User-Agent: Streamlit

Body: {
  "contract_text": "..."
}
```

### Ø§Ù„ Tokens Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©:

```
Input Tokens (ØªØ±Ø³Ù„ Ù„Ù€ Gemini):
â”œâ”€ Ù†Øµ Ø§Ù„Ø¹Ù‚Ø¯: 5,500 tokens (99% Ù…Ù† Ø§Ù„Ù€ input)
â”œâ”€ System prompt: 300 tokens
â”œâ”€ Extract prompt: 200 tokens
â””â”€ Total Input: 6,000 tokens

Cost: 6,000 Ã— ($0.30 / 1M) = $0.0018
```

### Ø§Ù„ Gemini API Call Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ:

```python
# Ø¯Ø§Ø®Ù„ app.py - Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Gemini API
response = client.models.generate_content(
    model="gemini-2.5-flash",
    contents=[
        {
            "role": "user",
            "parts": [
                {
                    "text": f"""
                    Ø£Ù†Øª Ù…Ø­Ù„Ù„ Ø´Ø±Ø¹ÙŠ Ù…ØªØ®ØµØµ ÙÙŠ Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©.
                    
                    Ø­Ù„Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù‚Ø¯ ÙˆØ§Ø³ØªØ®Ø±Ø¬ 5-15 Ø¨Ù†Ø¯ Ù…Ù‡Ù…:
                    {contract_text}
                    
                    Ù„ÙƒÙ„ Ø¨Ù†Ø¯ Ø£Ø¶Ù:
                    - Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
                    - Ø§Ù„ÙˆØµÙ
                    - Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø´Ø±Ø¹ÙŠØ© Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©
                    
                    Ø£Ø±Ø¬Ø¹ Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙƒÙ€ JSON ÙÙ‚Ø·
                    """
                }
            ]
        }
    ]
)
```

### Ø§Ù„ Response Ù…Ù† Gemini:

```json
{
    "candidates": [
        {
            "content": {
                "parts": [
                    {
                        "text": """
                        {
                            "clauses": [
                                {
                                    "id": 1,
                                    "title": "Ø¨Ù†Ø¯ Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„Ø«Ù…Ù†",
                                    "description": "ØªØ­Ø¯ÙŠØ¯ Ø³Ø¹Ø± Ø§Ù„ØµÙ†Ø¹Ø© Ø¨Ù€ 50,000 Ø±ÙŠØ§Ù„",
                                    "keywords": ["Ø§Ù„Ø³Ø¹Ø±", "Ø§Ù„Ø«Ù…Ù†", "Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„"],
                                    "risks": ["Ø§Ù„ØºØ±Ø±", "Ø§Ù„Ø¬Ù‡Ø§Ù„Ø©"]
                                },
                                {
                                    "id": 2,
                                    "title": "Ù…Ø¯Ø© Ø§Ù„ØªÙ†ÙÙŠØ°",
                                    "description": "18 Ø´Ù‡Ø± Ù…Ù† ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙˆÙ‚ÙŠØ¹",
                                    "keywords": ["Ø§Ù„Ù…Ø¯Ø©", "Ø§Ù„ØªÙ†ÙÙŠØ°", "Ø§Ù„Ø£Ø¬Ù„"],
                                    "risks": []
                                },
                                ...
                            ]
                        }
                        """
                    }
                ]
            },
            "finish_reason": "STOP"
        }
    ],
    "usage_metadata": {
        "prompt_token_count": 6000,
        "candidates_token_count": 950,
        "total_token_count": 6950
    }
}
```

### Ø§Ù„ Data ÙŠÙØ­ÙØ¸ ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø©:

```python
extracted_terms = [
    {
        "id": 1,
        "title": "Ø¨Ù†Ø¯ Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„Ø«Ù…Ù†",
        "description": "...",
        "keywords": ["Ø§Ù„Ø³Ø¹Ø±", "Ø§Ù„Ø«Ù…Ù†"],
        "risks": ["Ø§Ù„ØºØ±Ø±"]
    },
    # ... Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¨Ù†ÙˆØ¯
]
```

---

## ğŸ“‹ Request #2: Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ (File Search API Call)

### Ø§Ù„ÙˆÙ‚Øª: 30-75 Ø«Ø§Ù†ÙŠØ©
### Ù†ÙˆØ¹ Ø§Ù„Ù€ Request: `POST /v1beta/files:search`

### Ø§Ù„Ù€ Payload:

```json
{
    "name": "fileSearchStores/aaoifi-reference-store-vwvmgtb64hqq",
    "requests": [
        {
            "query": "Ø§Ù„Ø¹Ù‚Ø¯ ÙƒØ§Ù…Ù„: Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„Ø«Ù…Ù† ÙˆØ§Ù„Ù…Ø¯Ø© ÙˆØ§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª ÙˆØ§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© ÙˆØ§Ù„ØªØ¹ÙˆÙŠØ¶Ø§Øª ÙˆØ§Ù„ØºØ±Ø± ÙˆØ§Ù„Ø¬Ù‡Ø§Ù„Ø© ÙˆØ§Ù„Ø±Ø¨Ø§",
            "result_metadata": {
                "page_size": 10
            }
        }
    ]
}
```

### HTTP Headers:

```
POST https://generativelanguage.googleapis.com/v1beta/corpora/files:search HTTP/1.1
Host: generativelanguage.googleapis.com
Authorization: Bearer {GEMINI_API_KEY}
Content-Type: application/json

Body: {
    "name": "fileSearchStores/aaoifi-reference-store-vwvmgtb64hqq",
    "requests": [...]
}
```

### Ø§Ù„ Tokens Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©:

```
Input Tokens:
â”œâ”€ Query (Ø§Ù„Ø¨Ø­Ø«): 3,500 tokens
â””â”€ Metadata: 500 tokens
= 4,000 tokens input

Output Tokens:
â”œâ”€ 10 chunks Ù…Ù† AAOIFI: 8,000 tokens
â””â”€ Metadata: 500 tokens
= 8,500 tokens output

Total: 12,500 tokens
Cost: (4,000 Ã— $0.30 + 8,500 Ã— $2.50) / 1M = $0.02255
```

### Response Ù…Ù† File Search:

```json
{
    "results": [
        {
            "chunks": [
                {
                    "chunk": {
                        "name": "fileSearchStores/aaoifi-reference-store-vwvmgtb64hqq/chunks/chunk_12345",
                        "data": {
                            "string_value": "Ù…Ø¹ÙŠØ§Ø± Ø±Ù‚Ù… 23: Ø§Ù„Ø§Ø³ØªØµÙ†Ø§Ø¹ - ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø«Ù…Ù† Ù…Ø¹Ø±ÙˆÙØ§Ù‹ Ù…Ø­Ø¯Ø¯Ø§Ù‹ Ù„Ø§ ØºØ±Ø± ÙÙŠÙ‡..."
                        }
                    },
                    "relevant_score": 0.92
                },
                {
                    "chunk": {
                        "name": "fileSearchStores/aaoifi-reference-store-vwvmgtb64hqq/chunks/chunk_12346",
                        "data": {
                            "string_value": "Ø§Ù„Ø¬Ù‡Ø§Ù„Ø© Ù…Ø­Ø±Ù…Ø© ÙÙŠ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ© Ø·Ø¨Ù‚Ø§Ù‹ Ù„Ù‚ÙˆÙ„ Ø§Ù„Ø±Ø³ÙˆÙ„: (Ø¨ÙŠØ¹ Ø§Ù„ØºØ±Ø±)..."
                        }
                    },
                    "relevant_score": 0.88
                },
                // ... 8 chunks Ø£Ø®Ø±Ù‰
            ]
        }
    ]
}
```

### Ø§Ù„ Data ÙŠÙØ­ÙØ¸:

```python
general_chunks = [
    {
        "uid": "chunk_1",
        "content": "Ù…Ø¹ÙŠØ§Ø± Ø±Ù‚Ù… 23: Ø§Ù„Ø§Ø³ØªØµÙ†Ø§Ø¹...",
        "score": 0.92,
        "type": "general"
    },
    # ... 9 chunks Ø¥Ø¶Ø§ÙÙŠØ©
]
```

---

## ğŸ“‹ Requests #3-8: Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø¹Ù…Ù‘Ù‚ (5 Ø¨Ù†ÙˆØ¯ Ø­Ø³Ø§Ø³Ø© Ã— File Search API)

### Ø§Ù„ÙˆÙ‚Øª: 75-135 Ø«Ø§Ù†ÙŠØ©
### Ø¹Ø¯Ø¯ Ø§Ù„Ù€ Requests: 5 (Ù„ÙƒÙ„ Ø¨Ù†Ø¯ Ø­Ø³Ø§Ø³ ÙˆØ§Ø­Ø¯)

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø­Ø³Ø§Ø³Ø©

```python
# Ø¯Ø§Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯: ØªØ­Ø¯ÙŠØ¯ Ø£ÙŠ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø­Ø³Ø§Ø³Ø©
sensitive_keywords = [
    "Ø§Ù„ØºØ±Ø±", "Ø§Ù„Ø¬Ù‡Ø§Ù„Ø©", "Ø§Ù„Ø±Ø¨Ø§", "ÙØ§Ø¦Ø¯Ø© Ø§Ù„ØªØ£Ø®ÙŠØ±", 
    "Ø§Ù„Ø´Ø±Ø· Ø§Ù„Ø¨Ø§Ø·Ù„", "Ø§Ù„Ø¸Ù„Ù…", "Ø§Ù„Ø¥ÙƒØ±Ø§Ù‡", "Ø§Ù„ØªØ¹ÙˆÙŠØ¶", "Ø§Ù„Ø¶Ø±Ø±"
]

# Ù„Ù„Ø¹Ù‚Ø¯ Ù…Ø«Ù„Ø§Ù‹:
sensitive_clauses = [
    "Ø¨Ù†Ø¯ Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„Ø«Ù…Ù†",  # ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ "Ø§Ù„ØºØ±Ø±"
    "Ø¨Ù†Ø¯ Ø§Ù„ØªØ£Ø®ÙŠØ±",       # ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ "Ø§Ù„Ø±Ø¨Ø§"
    "Ø¨Ù†Ø¯ Ø§Ù„ØªØ¹ÙˆÙŠØ¶Ø§Øª",    # ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ "Ø§Ù„ØªØ¹ÙˆÙŠØ¶"
    # ...
]
```

### Request #3: Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¨Ù†Ø¯ Ø§Ù„Ø£ÙˆÙ„

```json
{
    "name": "fileSearchStores/aaoifi-reference-store-vwvmgtb64hqq",
    "requests": [
        {
            "query": "Ø§Ù„ØºØ±Ø± ÙÙŠ Ø§Ù„Ø¹Ù‚ÙˆØ¯ - Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„Ø«Ù…Ù† ØºÙŠØ± Ù…Ø­Ø¯Ø¯ - Ø¬Ù‡Ø§Ù„Ø© - Ù…Ø¹ÙŠØ§Ø± AAOIFI",
            "result_metadata": {
                "page_size": 2
            }
        }
    ]
}
```

### Response:

```json
{
    "results": [
        {
            "chunks": [
                {
                    "chunk": {
                        "data": {
                            "string_value": "Ø§Ù„ØºØ±Ø±: Ù‡Ùˆ Ø§Ù„Ø¨ÙŠØ¹ Ø§Ù„Ø°ÙŠ ÙŠØ´ØªÙ…Ù„ Ø¹Ù„Ù‰ Ø®Ø·Ø± ÙˆÙ…Ø¬Ù‡ÙˆÙ„..."
                        }
                    },
                    "relevant_score": 0.95
                },
                {
                    "chunk": {
                        "data": {
                            "string_value": "Ù‚Ø§Ù„ Ø§Ù„Ø¥Ù…Ø§Ù… Ù…Ø§Ù„Ùƒ: Ø¨ÙŠØ¹ Ø§Ù„ØºØ±Ø± Ù…Ø­Ø±Ù… Ø´Ø±Ø¹Ø§Ù‹..."
                        }
                    },
                    "relevant_score": 0.91
                }
            ]
        }
    ]
}
```

### Request #4: Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¨Ù†Ø¯ Ø§Ù„Ø«Ø§Ù†ÙŠ (Ø§Ù„Ø±Ø¨Ø§)

```json
{
    "name": "fileSearchStores/aaoifi-reference-store-vwvmgtb64hqq",
    "requests": [
        {
            "query": "Ø§Ù„Ø±Ø¨Ø§ ÙØ§Ø¦Ø¯Ø© Ø§Ù„ØªØ£Ø®ÙŠØ± ØªØ£Ø®ÙŠØ± Ø§Ù„Ø¯ÙØ¹ - Ù…Ø¹ÙŠØ§Ø± AAOIFI 3/2",
            "result_metadata": {
                "page_size": 2
            }
        }
    ]
}
```

### Response:

```json
{
    "results": [
        {
            "chunks": [
                {
                    "chunk": {
                        "data": {
                            "string_value": "ÙØ§Ø¦Ø¯Ø© Ø§Ù„ØªØ£Ø®ÙŠØ± Ù…Ø­Ø±Ù…Ø© Ø´Ø±Ø¹Ø§Ù‹ Ù„Ø£Ù†Ù‡Ø§ Ø±Ø¨Ø§..."
                        }
                    },
                    "relevant_score": 0.94
                },
                // ... chunk Ø¢Ø®Ø±
            ]
        }
    ]
}
```

### Requests #5-8: Ù†ÙØ³ Ø§Ù„Ù†Ù…Ø·

```
Request #5: "Ø§Ù„ØªØ¹ÙˆÙŠØ¶Ø§Øª - Ø§Ù„Ø¶Ø±Ø± - Ø§Ù„Ø®Ø³Ø§Ø±Ø© - AAOIFI"
Request #6: "Ø§Ù„Ø´Ø±ÙˆØ· Ø§Ù„Ø¨Ø§Ø·Ù„Ø© - Ø´Ø±ÙˆØ· ÙØ§Ø³Ø¯Ø© - AAOIFI"  
Request #7: "Ø§Ù„Ø¥ÙƒØ±Ø§Ù‡ - Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø± - Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ù…Ù„Ø²Ù… - AAOIFI"
Request #8: "Ø§Ù„Ø§Ø³ØªØµÙ†Ø§Ø¹ - Ø§Ù„ØªØ³Ù„ÙŠÙ… - Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© - AAOIFI"
```

### Ø§Ù„ Tokens Ù„ÙƒÙ„ Ø¨Ù†Ø¯:

```
Ù„ÙƒÙ„ Ø¨Ù†Ø¯:
â”œâ”€ Input: 700 tokens (Ø§Ù„Ø¨Ù†Ø¯ + Ø§Ù„Ù€ query)
â”œâ”€ Output: 3,000 tokens (2 chunks Ù…Ù† AAOIFI)
â””â”€ Total: 3,700 tokens

Ù„Ù€ 5 Ø¨Ù†ÙˆØ¯:
â”œâ”€ Input: 3,500 tokens
â”œâ”€ Output: 15,000 tokens
â””â”€ Total: 18,500 tokens

Cost: (3,500 Ã— $0.30 + 15,000 Ã— $2.50) / 1M = $0.03805
```

### Ø§Ù„ Data ÙŠÙØ­ÙØ¸:

```python
sensitive_chunks = {
    "Ø¨Ù†Ø¯ Ø§Ù„Ø³Ø¹Ø±": [
        {"content": "Ø§Ù„ØºØ±Ø±: Ù‡Ùˆ Ø§Ù„Ø¨ÙŠØ¹...", "score": 0.95},
        {"content": "Ù‚Ø§Ù„ Ø§Ù„Ø¥Ù…Ø§Ù… Ù…Ø§Ù„Ùƒ...", "score": 0.91}
    ],
    "Ø¨Ù†Ø¯ Ø§Ù„Ø±Ø¨Ø§": [
        {"content": "ÙØ§Ø¦Ø¯Ø© Ø§Ù„ØªØ£Ø®ÙŠØ±...", "score": 0.94},
        # ...
    ],
    # ... Ø§Ù„Ù…Ø²ÙŠØ¯
}
```

---

## ğŸ“‹ Request #9: Ø¯Ù…Ø¬ ÙˆØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ (Processing)

### Ø§Ù„ÙˆÙ‚Øª: 135-160 Ø«Ø§Ù†ÙŠØ©
### Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©: Data Processing (Ù…Ø­Ù„ÙŠØŒ Ø¨Ø¯ÙˆÙ† API)

### Ø§Ù„Ø®Ø·ÙˆØ§Øª:

```python
# 1. Ø¯Ù…Ø¬ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù€ chunks
all_chunks = general_chunks + [chunk for chunks in sensitive_chunks.values() for chunk in chunks]
# Ø§Ù„Ù†ØªÙŠØ¬Ø©: 10 + 10 = 20 chunk

# 2. Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙƒØ±Ø§Ø±
seen = set()
unique_chunks = []
for chunk in all_chunks:
    if chunk['content'] not in seen:
        unique_chunks.append(chunk)
        seen.add(chunk['content'])

# 3. Ø¥Ø¹Ø§Ø¯Ø© ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„Ù€ score
unique_chunks.sort(key=lambda x: x['score'], reverse=True)

# 4. Ø¥Ø¹Ø§Ø¯Ø© ØªØ±Ù‚ÙŠÙ…
for idx, chunk in enumerate(unique_chunks):
    chunk['uid'] = f"chunk_{idx + 1}"

# Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: 15-20 chunk ÙØ±ÙŠØ¯Ø©
```

### Ø§Ù„ Output:

```python
final_data = {
    "extracted_terms": [
        {
            "id": 1,
            "title": "Ø¨Ù†Ø¯ Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„Ø«Ù…Ù†",
            "keywords": ["Ø§Ù„Ø³Ø¹Ø±", "Ø§Ù„ØºØ±Ø±"],
            "risks": ["Ø§Ù„ØºØ±Ø±", "Ø§Ù„Ø¬Ù‡Ø§Ù„Ø©"]
        },
        # ... Ø§Ù„Ù…Ø²ÙŠØ¯
    ],
    "chunks": [
        {
            "uid": "chunk_1",
            "content": "Ø§Ù„ØºØ±Ø±: Ù‡Ùˆ Ø§Ù„Ø¨ÙŠØ¹ Ø§Ù„Ø°ÙŠ ÙŠØ´ØªÙ…Ù„ Ø¹Ù„Ù‰ Ø®Ø·Ø±...",
            "score": 0.95,
            "source": "AAOIFI"
        },
        # ... Ø§Ù„Ù…Ø²ÙŠØ¯
    ],
    "total_chunks": 18,
    "analysis_status": "completed"
}
```

---

## ğŸ“‹ Request #10: Ø­ÙØ¸ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ (File I/O)

### Ø§Ù„ÙˆÙ‚Øª: 160-180 Ø«Ø§Ù†ÙŠØ©
### Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©: File Writing

### Ø§Ù„Ù€ Payload (JSON ÙŠÙØ­ÙØ¸):

```json
{
    "timestamp": "2025-11-24T13:15:30.123456",
    "contract_summary": {
        "total_clauses": 12,
        "sensitive_clauses": 5,
        "processing_time_seconds": 180
    },
    "extracted_terms": [
        {
            "id": 1,
            "title": "Ø¨Ù†Ø¯ Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„Ø«Ù…Ù†",
            "description": "ØªØ­Ø¯ÙŠØ¯ Ø³Ø¹Ø± Ø§Ù„ØµÙ†Ø¹Ø©...",
            "keywords": ["Ø§Ù„Ø³Ø¹Ø±", "Ø§Ù„Ø«Ù…Ù†"],
            "risks": ["Ø§Ù„ØºØ±Ø±"]
        }
    ],
    "search_results": {
        "general_search": {
            "query": "Ø§Ù„Ø¹Ù‚Ø¯ ÙƒØ§Ù…Ù„: Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„Ø«Ù…Ù†...",
            "chunks_returned": 10,
            "top_score": 0.92
        },
        "deep_search": {
            "Ø¨Ù†Ø¯ Ø§Ù„Ø³Ø¹Ø±": {
                "query": "Ø§Ù„ØºØ±Ø± ÙÙŠ Ø§Ù„Ø¹Ù‚ÙˆØ¯...",
                "chunks_returned": 2,
                "top_score": 0.95
            }
        }
    },
    "chunks": [
        {
            "uid": "chunk_1",
            "content": "Ø§Ù„ØºØ±Ø±: Ù‡Ùˆ Ø§Ù„Ø¨ÙŠØ¹...",
            "score": 0.95
        }
    ]
}
```

### Ø§Ù„Ù…Ù„Ù ÙŠÙØ­ÙØ¸ Ø¹Ù„Ù‰:

```
results/analysis_20251124_131530.json
```

---

## ğŸ”„ Ù…Ù„Ø®Øµ ÙƒØ§Ù…Ù„ Data Flow Ù…Ø¹ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USER INPUT (Streamlit)                        â”‚
â”‚                    contract_text (5-20KB)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Request #1: Extract Terms   â”‚
        â”‚  Gemini API Call             â”‚
        â”‚  Input: 6,000 tokens         â”‚
        â”‚  Output: 950 tokens          â”‚
        â”‚  Cost: $0.0018               â”‚
        â”‚  Time: 30 sec                â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Extracted Clauses (5-15 Ø¨Ù†Ø¯)                        â”‚
        â”‚  â”œâ”€ id, title, keywords, risks                       â”‚
        â”‚  â”œâ”€ 5 Ù…Ù†Ù‡Ø§ Ø­Ø³Ø§Ø³Ø© (ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ø®Ø·Ø§Ø± Ø´Ø±Ø¹ÙŠØ©)           â”‚
        â”‚  â””â”€ 10 Ù…Ù†Ù‡Ø§ Ø¹Ø§Ø¯ÙŠØ©                                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Request #2: General Search  â”‚
        â”‚  File Search API Call        â”‚
        â”‚  Query: ÙƒÙ„ Ø§Ù„Ø¹Ù‚Ø¯ + keywords  â”‚
        â”‚  Input: 4,000 tokens         â”‚
        â”‚  Output: 8,500 tokens        â”‚
        â”‚  Result: 10 chunks (score 0.8-0.95)
        â”‚  Cost: $0.02255              â”‚
        â”‚  Time: 45 sec                â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Requests #3-8: Deep Search Ã— 5                      â”‚
        â”‚  (Ù„ÙƒÙ„ Ø¨Ù†Ø¯ Ø­Ø³Ø§Ø³ ÙˆØ§Ø­Ø¯)                               â”‚
        â”‚  â”œâ”€ #3: Ø§Ù„ØºØ±Ø± â†’ 2 chunks (score 0.90-0.95)        â”‚
        â”‚  â”œâ”€ #4: Ø§Ù„Ø±Ø¨Ø§ â†’ 2 chunks (score 0.89-0.94)        â”‚
        â”‚  â”œâ”€ #5: Ø§Ù„ØªØ¹ÙˆÙŠØ¶ â†’ 2 chunks                        â”‚
        â”‚  â”œâ”€ #6: Ø§Ù„Ø´Ø±ÙˆØ· Ø§Ù„Ø¨Ø§Ø·Ù„Ø© â†’ 2 chunks                â”‚
        â”‚  â””â”€ #7: Ø§Ù„Ø¥ÙƒØ±Ø§Ù‡ â†’ 2 chunks                        â”‚
        â”‚                                                      â”‚
        â”‚  Input: 3,500 tokens (5 Ø¨Ù†ÙˆØ¯)                     â”‚
        â”‚  Output: 15,000 tokens (10 chunks)                â”‚
        â”‚  Cost: $0.03805 (5 requests)                      â”‚
        â”‚  Time: 60 sec (12 sec Ù„ÙƒÙ„ ÙˆØ§Ø­Ø¯)                  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Processing: Merge & Dedup                           â”‚
        â”‚  â”œâ”€ Ø¯Ù…Ø¬ 10 + 10 = 20 chunk                         â”‚
        â”‚  â”œâ”€ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙƒØ±Ø§Ø±                                  â”‚
        â”‚  â”œâ”€ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ score                        â”‚
        â”‚  â””â”€ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: 15-18 chunk ÙØ±ÙŠØ¯Ø©          â”‚
        â”‚  Time: 25 sec                                       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Save Results                                        â”‚
        â”‚  â”œâ”€ JSON â†’ results/analysis_[timestamp].json       â”‚
        â”‚  â”œâ”€ Display â†’ Streamlit UI                         â”‚
        â”‚  â””â”€ Cache â†’ Session State                          â”‚
        â”‚  Time: 20 sec                                       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   FINAL OUTPUT (Streamlit)    â”‚
        â”‚   â”œâ”€ Extracted Terms (5-15)  â”‚
        â”‚   â”œâ”€ Relevant Chunks (15-20) â”‚
        â”‚   â”œâ”€ Scores (0.8-0.95)      â”‚
        â”‚   â”œâ”€ Download JSON/Text      â”‚
        â”‚   â””â”€ View History            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TOTAL TIME: 180 seconds (3 Ø¯Ù‚Ø§Ø¦Ù‚)
TOTAL COST: $0.0558
TOTAL REQUESTS: 8-10 API calls
TOTAL TOKENS: 35,000 tokens
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

---

## ğŸ“Š Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù€ Payload Ù„ÙƒÙ„ Request

| Request # | Ø§Ù„Ù†ÙˆØ¹ | Input Tokens | Output Tokens | Cost | Ø§Ù„Ù€ Payload |
|-----------|-------|-------------|--------------|------|----------|
| 1 | Gemini | 6,000 | 950 | $0.0018 | contract_text + extract_prompt |
| 2 | File Search | 4,000 | 8,500 | $0.0226 | contract_text + general_keywords |
| 3 | File Search | 700 | 3,000 | $0.0076 | sensitive_clause_1 + query |
| 4 | File Search | 700 | 3,000 | $0.0076 | sensitive_clause_2 + query |
| 5 | File Search | 700 | 3,000 | $0.0076 | sensitive_clause_3 + query |
| 6 | File Search | 700 | 3,000 | $0.0076 | sensitive_clause_4 + query |
| 7 | File Search | 700 | 3,000 | $0.0076 | sensitive_clause_5 + query |
| 8 | Processing | - | - | - | merge + dedup locally |
| 9 | File Save | - | - | - | JSON output |
| **TOTAL** | - | **13,700** | **27,450** | **$0.0550** | - |

---

## ğŸ” Retry Logic (ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„ÙØ´Ù„)

### Ø¥Ø°Ø§ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø£ÙŠ Request:

```python
# Ù…Ø«Ù„Ø§Ù‹: Request #4 (Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø±Ø¨Ø§) ÙØ´Ù„ 503 error

retry_attempt_1:
    wait(2 seconds)
    POST File Search Again
    if success: return chunks
    else: continue

retry_attempt_2:
    wait(4 seconds)
    POST File Search Again
    if success: return chunks
    else: skip this clause and continue
```

### Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©:

```
Ø§Ù„ÙØ´Ù„ ÙÙŠ 1 Ù…Ù† 5 Ø¨Ù†ÙˆØ¯:
â”œâ”€ Request Ø§Ù„Ø£ÙˆÙ„: $0.0076
â”œâ”€ Retry 1: $0.0076
â”œâ”€ Retry 2: $0.0076
â””â”€ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: $0.0228 (Ø¨Ø¯Ù„ $0.0076)

Ø§Ù„Ø²ÙŠØ§Ø¯Ø©: $0.0152 Ù„ÙƒÙ„ ÙØ´Ù„
```

---

## ğŸ¯ Ù…Ø«Ø§Ù„ Ø¹Ù…Ù„ÙŠ: Ø¹Ù‚Ø¯ Ø¨Ù€ 5KB

```
INPUT:
â”œâ”€ Ø§Ù„Ø¹Ù‚Ø¯: "Ù‡Ø°Ø§ Ø¹Ù‚Ø¯ Ø§Ø³ØªØµÙ†Ø§Ø¹... ÙŠÙ„ØªØ²Ù… Ø§Ù„ØµØ§Ù†Ø¹ Ø¨Ø¥Ù†Ø´Ø§Ø¡..."
â”œâ”€ Ø§Ù„Ø­Ø¬Ù…: 5,000 Ø­Ø±Ù = 5KB
â””â”€ Ø¹Ø¯Ø¯ Ø§Ù„ÙƒÙ„Ù…Ø§Øª: 1,200

PROCESSING:
â”œâ”€ Request 1: Ø§Ø³ØªØ®Ø±Ø§Ø¬ 7 Ø¨Ù†ÙˆØ¯ (Ù…Ù† Ø¨ÙŠÙ†Ù‡Ù… 4 Ø­Ø³Ø§Ø³Ø©)
â”œâ”€ Request 2: Ø¨Ø­Ø« Ø¹Ù† ÙƒÙ„ 7 Ø¨Ù†ÙˆØ¯ + keywords = 10 chunks
â”œâ”€ Requests 3-6: Ø¨Ø­Ø« Ù…Ø¹Ù…Ù‘Ù‚ Ù„Ù€ 4 Ø¨Ù†ÙˆØ¯ Ø­Ø³Ø§Ø³Ø© = 8 chunks
â”œâ”€ Processing: Ø¯Ù…Ø¬ 18 chunk â†’ 16 ÙØ±ÙŠØ¯
â””â”€ Save: JSON â†’ results/analysis_...json

OUTPUT:
â”œâ”€ extracted_terms: 7 Ø¨Ù†ÙˆØ¯
â”œâ”€ chunks: 16 chunk Ù…Ø¹ scores (0.88-0.95)
â”œâ”€ total_tokens_used: 25,000
â”œâ”€ total_cost: $0.0515
â””â”€ processing_time: 180 sec
```

---

## ğŸ” Detailed Request/Response Examples

### Example: Request #3 (Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ØºØ±Ø±)

```
OUTGOING REQUEST (app.py â†’ Google API):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
POST /v1beta/corpora/files:search HTTP/1.1
Authorization: Bearer {GEMINI_API_KEY}
Content-Type: application/json

{
    "name": "fileSearchStores/aaoifi-reference-store-vwvmgtb64hqq",
    "requests": [
        {
            "query": "Ø§Ù„ØºØ±Ø± ÙÙŠ Ø§Ù„Ø¹Ù‚ÙˆØ¯ ÙˆØ§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ø§Ø³ØªØµÙ†Ø§Ø¹ - Ø§Ù„Ø³Ø¹Ø± ØºÙŠØ± Ù…Ø­Ø¯Ø¯ - Ø¬Ù‡Ø§Ù„Ø© - Ù…Ø¹Ø§ÙŠÙŠØ± AAOIFI",
            "result_metadata": {
                "page_size": 2
            }
        }
    ]
}

INCOMING RESPONSE (Google API â†’ app.py):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
HTTP/1.1 200 OK
Content-Type: application/json

{
    "results": [
        {
            "chunks": [
                {
                    "chunk": {
                        "name": "fileSearchStores/aaoifi-reference-store-vwvmgtb64hqq/chunks/12345abc",
                        "data": {
                            "string_value": "Ø§Ù„ØºØ±Ø±: Ù‡Ùˆ Ø§Ù„Ø¨ÙŠØ¹ Ø§Ù„Ø°ÙŠ ÙŠØ´ØªÙ…Ù„ Ø¹Ù„Ù‰ Ø®Ø·Ø± ÙˆÙ…Ø¬Ù‡ÙˆÙ„. Ù‚Ø§Ù„ Ø§Ù„Ø¥Ù…Ø§Ù… Ø§Ù„Ù†ÙˆÙˆÙŠ..."
                        }
                    },
                    "relevant_score": 0.948
                },
                {
                    "chunk": {
                        "name": "fileSearchStores/aaoifi-reference-store-vwvmgtb64hqq/chunks/12345def",
                        "data": {
                            "string_value": "Ù‚Ø§Ù„ Ø§Ù„Ø±Ø³ÙˆÙ„ (Øµ): (Ù„Ø§ ØªØ¨ÙŠØ¹ÙˆØ§ Ø§Ù„ØºØ±Ø±)ØŒ ÙˆØ§Ù„ØºØ±Ø± Ù…Ø­Ø±Ù… Ø´Ø±Ø¹Ø§Ù‹ ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù‚ÙˆØ¯..."
                        }
                    },
                    "relevant_score": 0.912
                }
            ]
        }
    ],
    "attribution_token": "...",
    "used_stored_chunks_count": 2
}

PROCESSING IN APP:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
chunks[0] = {
    "uid": "chunk_X",
    "content": "Ø§Ù„ØºØ±Ø±: Ù‡Ùˆ Ø§Ù„Ø¨ÙŠØ¹ Ø§Ù„Ø°ÙŠ ÙŠØ´ØªÙ…Ù„ Ø¹Ù„Ù‰ Ø®Ø·Ø± ÙˆÙ…Ø¬Ù‡ÙˆÙ„...",
    "score": 0.948,
    "clause": "Ø¨Ù†Ø¯ Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„Ø«Ù…Ù†",
    "source": "AAOIFI Reference"
}
```

---

## ğŸ“ˆ Flow Diagram (Visual)

```
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚  User Input     â”‚
                          â”‚  (5-20KB Text)  â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                             â”‚
              â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ API Call #1  â”‚         â”‚ Stream Response  â”‚
              â”‚ (Gemini)     â”‚         â”‚ to UI in Real    â”‚
              â”‚              â”‚         â”‚ Time             â”‚
              â”‚ Extract 7-15 â”‚         â”‚                  â”‚
              â”‚ Clauses      â”‚         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
                    â”‚                        â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
         â”‚ 7 Clauses Extracted â”‚            â”‚
         â”‚ + Keywords + Risks  â”‚            â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
                    â”‚                        â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
      â”‚ Identify 4-5 Sensitive â”‚            â”‚
      â”‚ Clauses (Ø§Ù„ØºØ±Ø±ØŒ Ø§Ù„Ø±Ø¨Ø§ØŒ etc) â”‚       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
                 â”‚                         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
    â”‚ API Calls #2-7 Parallel   â”‚          â”‚
    â”‚ General + Deep Searches   â”‚          â”‚
    â”‚ File Search Store         â”‚          â”‚
    â”‚                           â”‚          â”‚
    â”‚ â”œâ”€ General: 10 chunks    â”‚          â”‚
    â”‚ â”œâ”€ Deep 1: 2 chunks     â”‚          â”‚
    â”‚ â”œâ”€ Deep 2: 2 chunks     â”‚          â”‚
    â”‚ â”œâ”€ Deep 3: 2 chunks     â”‚          â”‚
    â”‚ â””â”€ Deep 4: 2 chunks     â”‚          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
                 â”‚                         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
    â”‚ Local Processing          â”‚          â”‚
    â”‚ â”œâ”€ Merge 18 chunks        â”‚          â”‚
    â”‚ â”œâ”€ Remove Duplicates      â”‚          â”‚
    â”‚ â”œâ”€ Sort by Score          â”‚          â”‚
    â”‚ â””â”€ Result: 15-18 chunks   â”‚          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
                 â”‚                         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
    â”‚ Save to File              â”‚          â”‚
    â”‚ results/analysis_*.json   â”‚          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
                 â”‚                         â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
         â”‚ Return JSON    â”‚                â”‚
         â”‚ + Display in   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Streamlit UI   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ Ø§Ù„Ø®Ù„Ø§ØµØ©

```
Ø¹Ù…Ù„ÙŠØ© ÙƒØ§Ù…Ù„Ø© = 8-10 API Requests

1. Extraction:   1 Gemini Call
2. Search:       1 General + 4-5 Deep File Search Calls
3. Retry:        0-2 Calls Ø¥Ø¶Ø§ÙÙŠØ© (ÙÙŠ 10% Ù…Ù† Ø§Ù„Ø­Ø§Ù„Ø§Øª)
4. Processing:   Merge + Dedup Ù…Ø­Ù„ÙŠØ§Ù‹

Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù€ Tokens:   ~25,000-35,000
Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙƒÙ„ÙØ©:     ~$0.0515-0.0620
Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙˆÙ‚Øª:       ~180 Ø«Ø§Ù†ÙŠØ© (3 Ø¯Ù‚Ø§Ø¦Ù‚)
```

---

**Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«:** 24 Ù†ÙˆÙÙ…Ø¨Ø± 2025
