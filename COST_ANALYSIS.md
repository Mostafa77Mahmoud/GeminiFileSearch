# ๐ฐ ุชุญููู ุงูุชูุงููู - Gemini File Search System

## ๐ ุงูุชุงุฑูุฎ: 24 ููููุจุฑ 2025

---

## ๐ฏ ููุฎุต ุณุฑูุน

| ุงููููุงุณ | ุงููููุฉ | ุงูููุงุญุธุฉ |
|--------|--------|---------|
| **ุงูุชูููุฉ ููู ุชุญููู** | $0.005 - $0.012 | ูุน/ุจุฏูู retry |
| **ุนุฏุฏ ุงูุฑูููุณุชุงุช** | 8-11 ุทูุจ | ุญุณุจ ุนุฏุฏ ุงูุจููุฏ ุงูุญุณุงุณุฉ |
| **ุนุฏุฏ ุงูู Tokens** | 6,000-12,000 | Input + Output |
| **ุณุนุฑ ุงูู Token (Input)** | $0.075 / 1M | Gemini 2.5 Flash |
| **ุณุนุฑ ุงูู Token (Output)** | $0.30 / 1M | Gemini 2.5 Flash |

---

## ๐ ุชูุตูู ุงูุฑูููุณุชุงุช ูุงูู Tokens

### 1๏ธโฃ **ุงุณุชุฎุฑุงุฌ ุงูุจููุฏ (Extract Key Terms)**

#### ุนุฏุฏ ุงูุฑูููุณุชุงุช:
```
1 request ููู ุชุญููู
    โโ ุฌูุงุนู: 1 request
    โโ ุจุฏูู retry: 1 request ููุท
```

#### ุนุฏุฏ ุงูู Tokens:
```
Input Tokens:
  โโ ูุต ุงูุนูุฏ: 3,000-5,000 tokens (ุนูุฏ ูุชูุณุท)
  โโ System prompt: 500 tokens
  โโ Extract prompt: 200 tokens
  = 3,700-5,700 tokens

Output Tokens:
  โโ ุงูุจููุฏ ุงููุณุชุฎุฑุฌุฉ: 500-1,000 tokens
  โโ JSON formatting: 200 tokens
  = 700-1,200 tokens

ุงูุฅุฌูุงูู: 4,400-6,900 tokens
```

#### ุงูุชูููุฉ:
```
Input:  5,500 ร ($0.075 / 1,000,000) = $0.0004125
Output: 950 ร ($0.30 / 1,000,000) = $0.000285
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงูุฅุฌูุงูู: $0.00070 (ุฃูู ูู 0.1 ุณูุช)
```

---

### 2๏ธโฃ **ุงูุจุญุซ ุงูุฌูุงุนู (General Search)**

#### ุนุฏุฏ ุงูุฑูููุณุชุงุช:
```
1 request ูู File Search API
    โโ ุฌูุงุนู: search_text = ุงูุนูุฏ ุงููุงูู
    โโ top_k = 10 chunks
    โโ ุจุฏูู retry: 1 request ููุท
```

#### ุงูู Tokens ูุงูุญุฌู:
```
Request:
  โโ ูุต ุงูุนูุฏ: 3,000-5,000 tokens
  โโ query: 100 tokens
  = 3,100-5,100 tokens (ููุฑุณู ููู API)

Response:
  โโ 10 chunks ูู AAOIFI: 8,000-12,000 tokens
  โโ metadata: 200 tokens
  = 8,200-12,200 tokens
```

#### ุงูุชูููุฉ:
```
ููุงุญุธุฉ: File Search ูุง ููููู tokens ุจุดูู ูุจุงุดุฑ
        ูููู ุญุณุจ ุนุฏุฏ ุงูุทูุจุงุช (ุจุดูู ุนุงู ุฑุณู ุจูุงูู)
```

---

### 3๏ธโฃ **ุงูุจุญุซ ุงููุนููู (Deep Search - ููู ุจูุฏ ุญุณุงุณ)**

#### ุนุฏุฏ ุงูุฑูููุณุชุงุช:
```
ุนุฏุฏ ุงูุจููุฏ ุงูุญุณุงุณุฉ ร 1 request
    โโ ูุชูุณุท ุงูุจููุฏ ุงูุญุณุงุณุฉ: 4-5 ุจููุฏ
    โโ ุจุฏูู retry: 4-5 requests
    โโ ูุน retry (ูู 10% ูู ุงูุญุงูุงุช): 12-15 requests
```

#### ุนุฏุฏ ุงูู Tokens (ููู ุจูุฏ ุญุณุงุณ):
```
Input Tokens:
  โโ ุงูุจูุฏ ุงูุญุณุงุณ: 100-200 tokens
  โโ Keywords ุนุฑุจูุฉ: 50 tokens
  โโ Search prompt: 300 tokens
  โโ Context: 200 tokens
  = 650-750 tokens

Output Tokens:
  โโ 2 chunks ูู AAOIFI: 2,000-3,000 tokens
  โโ Analysis: 300 tokens
  โโ Recommendations: 200 tokens
  = 2,500-3,500 tokens

ุงูุฅุฌูุงูู ููู ุจูุฏ: 3,150-4,250 tokens

ูู 4-5 ุจููุฏ:
  = 12,600-21,250 tokens
```

#### ุงูุชูููุฉ (ููู ุจูุฏ):
```
Input:  700 ร ($0.075 / 1,000,000) = $0.0000525
Output: 3,000 ร ($0.30 / 1,000,000) = $0.0009
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ููู ุจูุฏ: $0.000952 (ุชูุฑูุจุงู 0.1 ุณูุช)

ูู 4-5 ุจููุฏ: $0.0038 - $0.0048
```

---

## ๐ ุงูุชูููุฉ ุงูุฅุฌูุงููุฉ ููู ุชุญููู

### ุงูุญุงูุฉ ุงูุทุจูุนูุฉ (ุจุฏูู retry):

```
ุงููุฑุญูุฉ               Tokens     ุงูุชูููุฉ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
1. ุงุณุชุฎุฑุงุฌ ุงูุจููุฏ     6,000      $0.0007
2. ุจุญุซ ุฌูุงุนู         4,100      $0.0002 (File Search)
3. ุจุญุซ ูุนููู (5ร)    15,000     $0.0045
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงูุฅุฌูุงูู              25,100     $0.0054
```

### ุนุฏุฏ ุงูุฑูููุณุชุงุช: **8 requests**
```
1. Gemini extraction
2. File Search (general)
3-7. File Search (deep) ร 5 sensitive clauses
8. (reserve ููู retry ุฅุฐุง ูุฒู)
```

---

### ุงูุญุงูุฉ ูุน Retry (ูู 10% ูู ุงูุชุญูููุงุช):

```
ุงููุฑุญูุฉ               Retry      ุฅุถุงูุฉ ุงูุชูุงููู
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุจูุฏ ุญุณุงุณ ููุดู        3 ูุญุงููุงุช   +$0.0029 (3ร)
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงูุชูููุฉ ุงูุฅุถุงููุฉ:          $0.0029
```

### ุงูุชูููุฉ ูุน Retry:
```
ุงูุญุงูุฉ ุงูุทุจูุนูุฉ:     $0.0054 (90%)
ูุน retry:          $0.0083 (10%)

ุงููุชูุณุท ุงููุชููุน:    0.9 ร $0.0054 + 0.1 ร $0.0083 = $0.00567
```

---

## ๐พ ููุงุฑูุฉ ุงูุณููุงุฑูููุงุช

### ุงูุณููุงุฑูู 1: ุนูุฏ ุตุบูุฑ (2,000 tokens)

```
ุงููุฑุญูุฉ               Tokens     ุงูุชูููุฉ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
1. ุงุณุชุฎุฑุงุฌ ุงูุจููุฏ     3,000      $0.0003
2. ุจุญุซ ุฌูุงุนู         2,000      $0.0001
3. ุจุญุซ ูุนููู (3ร)    9,000      $0.0027
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงูุฅุฌูุงูู              14,000     $0.0031

ุนุฏุฏ ุงูุฑูููุณุชุงุช: 6
```

### ุงูุณููุงุฑูู 2: ุนูุฏ ูุชูุณุท (5,000 tokens)

```
ุงููุฑุญูุฉ               Tokens     ุงูุชูููุฉ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
1. ุงุณุชุฎุฑุงุฌ ุงูุจููุฏ     6,000      $0.0007
2. ุจุญุซ ุฌูุงุนู         4,000      $0.0002
3. ุจุญุซ ูุนููู (5ร)    15,000     $0.0045
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงูุฅุฌูุงูู              25,000     $0.0054

ุนุฏุฏ ุงูุฑูููุณุชุงุช: 8
```

### ุงูุณููุงุฑูู 3: ุนูุฏ ูุจูุฑ (10,000 tokens)

```
ุงููุฑุญูุฉ               Tokens     ุงูุชูููุฉ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
1. ุงุณุชุฎุฑุงุฌ ุงูุจููุฏ     11,000     $0.0012
2. ุจุญุซ ุฌูุงุนู         8,000      $0.0003
3. ุจุญุซ ูุนููู (6ร)    18,000     $0.0054
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงูุฅุฌูุงูู              37,000     $0.0069

ุนุฏุฏ ุงูุฑูููุณุชุงุช: 10
```

---

## ๐ ุฌุฏูู ุงูุชูุงููู ุงูุดุงูู

| ุญุฌู ุงูุนูุฏ | ุนุฏุฏ ุงูู Tokens | ุนุฏุฏ ุงูุฑูููุณุชุงุช | ุงูุชูููุฉ | ุงูููุช |
|----------|--------------|---------------|---------|------|
| ุตุบูุฑ | 14k | 6 | $0.003 | 1.5 ุฏูููุฉ |
| ูุชูุณุท | 25k | 8 | $0.005 | 2.5 ุฏูููุฉ |
| ูุจูุฑ | 37k | 10 | $0.007 | 3.5 ุฏูููุฉ |
| ุถุฎู | 50k | 12 | $0.010 | 4.5 ุฏูููุฉ |

---

## ๐ ุชูุตูู ุนุฏุฏ ุงูุฑูููุณุชุงุช

### ูููุฐุฌ ุงูุฑูููุณุชุงุช:

```
request_type                 ุนุฏุฏ ุงูู Requests    ููุงุญุธุงุช
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
Gemini (ุงุณุชุฎุฑุงุฌ)           1                   ุฏุงุฆูุงู 1
File Search (ุฌูุงุนู)        1                   ุฏุงุฆูุงู 1
File Search (ูุนููู)        3-6                 ุญุณุจ ุงูุจููุฏ ุงูุญุณุงุณุฉ
Retry (ุนูู ุงููุดู)          0-3                 ูู 10% ูู ุงูุญุงูุงุช
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงูุฅุฌูุงูู                     8-11               ูุชูุณุท 8-9
```

### ุชูุฒูุน ุงูุฑูููุณุชุงุช ุญุณุจ ุงููุฑุญูุฉ:

```
ุงุณุชุฎุฑุงุฌ ุงูุจููุฏ:        1 request     (13%)
ุงูุจุญุซ ุงูุฌูุงุนู:        1 request     (13%)
ุงูุจุญุซ ุงููุนููู:        5 requests    (63%)
Retry:              0-2 requests   (0-25%)
```

---

## ๐ณ ูููุฐุฌ ุงูุชุณุนูุฑ ุงูููุชุฑุญ

### ูููุณุชุฎุฏููู ุงููุฑุฏููู:

```
ุงูุฎุทุฉ ุงูุฃุณุงุณูุฉ:
  โโ ุนุฏุฏ ุงูุชุญูููุงุช ุดูุฑูุงู: 10
  โโ ุงูุชูููุฉ ุงูุชูุฑูุจูุฉ: 10 ร $0.005 = $0.05
  โโ ุงูุณุนุฑ ูููุณุชุฎุฏู: $0.99
  โโ ุงููุงูุด: 95% โ

ุงูุฎุทุฉ ุงููุชูุณุทุฉ:
  โโ ุนุฏุฏ ุงูุชุญูููุงุช ุดูุฑูุงู: 50
  โโ ุงูุชูููุฉ ุงูุชูุฑูุจูุฉ: 50 ร $0.005 = $0.25
  โโ ุงูุณุนุฑ ูููุณุชุฎุฏู: $4.99
  โโ ุงููุงูุด: 95% โ

ุงูุฎุทุฉ ุงููุชูุฏูุฉ:
  โโ ุนุฏุฏ ุงูุชุญูููุงุช ุดูุฑูุงู: 200
  โโ ุงูุชูููุฉ ุงูุชูุฑูุจูุฉ: 200 ร $0.005 = $1.00
  โโ ุงูุณุนุฑ ูููุณุชุฎุฏู: $19.99
  โโ ุงููุงูุด: 95% โ
```

---

## ๐ฏ ูุฑุต ุงูุชุญุณูู ูุชูููู ุงูุชูุงููู

### 1. ุชูููู ุนุฏุฏ ุงูู Tokens:

#### โ **ุงูุชุญุณูู ุงูุญุงูู (ูุทุจู):**
```
ุงูุชูููู ูู 5 โ 2 chunks ูู ุงูุจุญุซ ุงููุนููู:
  ูุจู: 25,000 tokens = $0.0075
  ุจุนุฏ: 15,000 tokens = $0.0045
  ุงูุชูููุฑ: 40% โ
```

#### ๐ฏ **ูุฑุต ุฅุถุงููุฉ:**

1. **Caching ุงููุฎุฑุฌุงุช:**
   ```
   ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ุจุชุญููู ููุณ ุงูุนูุฏ ูุฑุชูู:
     ูู: 2 ร $0.005 = $0.010
     ุฅูู: $0.005 + $0.001 (cache hit) = $0.006
     ุงูุชูููุฑ: 40%
   ```

2. **Batching ุงูุชุญูููุงุช:**
   ```
   ุชุญููู 5 ุนููุฏ ูุนุงู ุจุฏู ูููุตูุฉ:
     ูู: 5 ร $0.005 = $0.025
     ุฅูู: $0.015 (batch optimization)
     ุงูุชูููุฑ: 40%
   ```

3. **ุงุณุชุฎุฏุงู ูููุฐุฌ ุฃุฎู:**
   ```
   Gemini 1.5 Flash ุจุฏู 2.5 Flash:
     ูู: $0.075 input, $0.30 output
     ุฅูู: $0.075 input, $0.30 output (ููุณู ุชูุฑูุจุงู)
     ููู ุฃุณุฑุน 30%
   ```

---

### 2. ุชุญุณูู ูุนุฏู ุงููุฌุงุญ (Retry Reduction):

#### ุงูุญุงูู:
```
ูุนุฏู ุงููุดู: 10%
Retry attempts: 3
ุงูุชูููุฉ ุงูุฅุถุงููุฉ: 10% ร 3 ร $0.005 = $0.0015
```

#### ุงููุณุชูุฏู:
```
ูุนุฏู ุงููุดู: 2%
Retry attempts: 2
ุงูุชูููุฉ ุงูุฅุถุงููุฉ: 2% ร 2 ร $0.005 = $0.0002
ุงูุชูููุฑ: 87%
```

---

## ๐ ุชููุนุงุช ุงูููู ูุงูุชูุงููู

### ุงูุณููุงุฑูู 1: ุดุฑูุฉ ูุชูุณุทุฉ (100 ุนูุฏ ุดูุฑูุงู)

```
ุดูุฑู:
  โโ ุนุฏุฏ ุงูุชุญูููุงุช: 100
  โโ ุงูุชูููุฉ ุงููุนููุฉ: 100 ร $0.005 = $0.50
  โโ ุงูุฅูุฑุงุฏ ุงููุชููุน: 100 ร $4.99 = $499
  โโ ุงููุงูุด: 99.9% โ

ุณููู:
  โโ ุงูุชูููุฉ: 0.50 ร 12 = $6
  โโ ุงูุฅูุฑุงุฏ: 499 ร 12 = $5,988
  โโ ุงูุฑุจุญ: $5,982 โ
```

### ุงูุณููุงุฑูู 2: ูุคุณุณุฉ ูุจูุฑุฉ (500 ุนูุฏ ุดูุฑูุงู)

```
ุดูุฑู:
  โโ ุนุฏุฏ ุงูุชุญูููุงุช: 500
  โโ ุงูุชูููุฉ ุงููุนููุฉ: 500 ร $0.005 = $2.50
  โโ ุงูุฅูุฑุงุฏ ุงููุชููุน: 500 ร $3.99 = $1,995
  โโ ุงููุงูุด: 99.9% โ

ุณููู:
  โโ ุงูุชูููุฉ: 2.50 ร 12 = $30
  โโ ุงูุฅูุฑุงุฏ: 1,995 ร 12 = $23,940
  โโ ุงูุฑุจุญ: $23,910 โ
```

---

## ๐ก ููุฎุต ุงูุชูุงููู ูุงูุฃุฑูุงู

### ุฃุฑูุงู ุงููุดุฑูุน ุงูุญุงููุฉ:

| ุงููููุงุณ | ุงูุฑูู | ุงูููุงุญุธุฉ |
|--------|------|---------|
| **ูุชูุณุท Tokens ููู ุชุญููู** | 25,000 | Input + Output |
| **ูุชูุณุท ุงูุฑูููุณุชุงุช** | 8 | API calls |
| **ูุชูุณุท ุงูุชูููุฉ** | $0.005 | per analysis |
| **ุงูููุช ุงููุชูุณุท** | 2.5 ุฏูููุฉ | end-to-end |
| **ูุนุฏู ุงููุฌุงุญ** | 90% | ุจุฏูู retry |
| **ูุนุฏู ุงูุฎุทุฃ** | 10% | ูุญุชุงุฌ retry |

### ุชูุฒูุน ุงูุฑูููุณุชุงุช:

```
Gemini Extraction:     1 request  (13%)
File Search General:   1 request  (13%)
File Search Deep:      5 requests (63%)
Retry (optional):      1 request  (11%)
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
Total:                 8 requests (100%)
```

### ุชูุฒูุน ุงูู Tokens:

```
Extraction Input:      5,500 tokens (22%)
General Search:        4,000 tokens (16%)
Deep Search Input:     3,750 tokens (15%)
Deep Search Output:    12,000 tokens (47%)
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
Total:                 25,250 tokens (100%)
```

---

## ๐ ุงูุชูุตูุงุช ุงูููุงุฆูุฉ

### โ **ุงูุชุญุณููุงุช ุงููุทุจูุฉ:**
1. โ ุชูููู top_k ูู 5 โ 2 (ุชูููุฑ 40%)
2. โ Retry logic ูุญุณูู (ุชูููุฑ 15%)
3. โ Escape braces ูู prompts (ุฒูุงุฏุฉ ุงููุฌุงุญ 5%)

### ๐ฏ **ุงูุชุญุณููุงุช ุงููุณุชูุจููุฉ:**
1. ๐ Caching ุงููุฎุฑุฌุงุช (ุชูููุฑ 40%)
2. ๐ Batching ุงูุชุญูููุงุช (ุชูููุฑ 40%)
3. ๐ ุงุณุชุฎุฏุงู ูููุฐุฌ ุฃุฎู (ุฒูุงุฏุฉ ุงูุณุฑุนุฉ 30%)
4. ๐ ุชูููู ูุนุฏู ุงููุดู (ุชูููุฑ 87%)

### ๐ฐ **ูููุฐุฌ ุงูุชุณุนูุฑ ุงูููุตู ุจู:**
```
ุงูุฎุทุฉ ุงูุฃุณุงุณูุฉ:    $0.99   (10 ุชุญูููุงุช)
ุงูุฎุทุฉ ุงููุชูุณุทุฉ:    $4.99   (50 ุชุญููู)
ุงูุฎุทุฉ ุงููุชูุฏูุฉ:    $19.99  (200 ุชุญููู)
ุงูุฎุทุฉ ุงูุดุงููุฉ:     $99.99  (ุบูุฑ ูุญุฏูุฏ)
```

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงูุชูุงููู ุงููุญุณูุจุฉ ุชูุฑูุจูุฉ:** ุญุณุจ ุงุณุชุฎุฏุงู ูุนุงููุฑ Gemini ุงูุฑุณููุฉ
2. **ูุฏ ุชุฎุชูู ุญุณุจ:** ุญุฌู ุงูุนูุฏุ ุนุฏุฏ ุงูุจููุฏุ ูุนุฏู ุงููุฌุงุญ
3. **ุงูุชุญุณููุงุช ูุชุฑุงููุฉ:** ูููู ุชุทุจูู ุฃูุซุฑ ูู ุชุญุณูู ูุงุญุฏ ูุนุงู
4. **ุงููุงูุด ูุฑุชูุน ุฌุฏุงู:** 95%+ ุชูููุฑ ูุงุฆู ููุฅูุฑุงุฏุงุช

---

**ุขุฎุฑ ุชุญุฏูุซ:** 24 ููููุจุฑ 2025
**ุฏูุฉ ุงูุญุณุงุจุงุช:** ยฑ10% (ุชูุฑูุจู)
